using Microsoft.VisualStudio.TestTools.UnitTesting;
using FluentAssertions;

namespace LevelUp.CheckCalculator.Tests
{
    [TestClass]
    public class CalculatorTests
    {
        [TestMethod]
        public void DiscountToApply_MiscellaneousTests()
        {
            /* 4 States
             * Compare 'Payment' to 'Due W/Tax' where 'Due W/Tax' is less than, equal, greater than, and 0
             * 
             * 4 States
             * Compare 'MFC' to 'Payment' where 'MFC' is less than, equal, greater than, and 0
             * 
             * 5 States
             * Compare 'Exempt' to 'MFC' or 'Due W/Tax' where 'Exempt' is less than, equal, greater than, and 0
             * 
             * Results in 4 * 4 * 5 test cases.
             */
            int[,] values = {
                //MFC, Payment, Due W/Tax, Tax, Exempt, Expected Discount
                {5, 10, 10, 1, 3, 5},
                {5, 10, 10, 1, 5, 4},
                {5, 10, 10, 1, 10, 0},
                {5, 10, 10, 1, 20, 0},
                {5, 10, 10, 1, 0, 5},
                {10, 10, 10, 1, 3, 6},
                {10, 10, 10, 1, 5, 4},
                {10, 10, 10, 1, 10, 0},
                {10, 10, 10, 1, 20, 0},
                {10, 10, 10, 1, 0, 9},
                {20, 10, 10, 1, 3, 6},
                {20, 10, 10, 1, 5, 4},
                {20, 10, 10, 1, 10, 0},
                {20, 10, 10, 1, 20, 0},
                {20, 10, 10, 1, 0, 9},
                {0, 10, 10, 1, 3, 0},
                {0, 10, 10, 1, 5, 0},
                {0, 10, 10, 1, 10, 0},
                {0, 10, 10, 1, 20, 0},
                {0, 10, 10, 1, 0, 0},
                {5, 10, 11, 1, 3, 5},
                {5, 10, 11, 1, 5, 5},
                {5, 10, 11, 1, 10, 0},
                {5, 10, 11, 1, 20, 0},
                {5, 10, 11, 1, 0, 5},
                {10, 10, 11, 1, 3, 7},
                {10, 10, 11, 1, 5, 5},
                {10, 10, 11, 1, 10, 0},
                {10, 10, 11, 1, 20, 0},
                {10, 10, 11, 1, 0, 10},
                {20, 10, 11, 1, 3, 7},
                {20, 10, 11, 1, 5, 5},
                {20, 10, 11, 1, 10, 0},
                {20, 10, 11, 1, 20, 0},
                {20, 10, 11, 1, 0, 10},
                {0, 10, 11, 1, 3, 0},
                {0, 10, 11, 1, 5, 0},
                {0, 10, 11, 1, 10, 0},
                {0, 10, 11, 1, 20, 0},
                {0, 10, 11, 1, 0, 0},
                {5, 10, 12, 1, 3, 5},
                {5, 10, 12, 1, 5, 5},
                {5, 10, 12, 1, 10, 1},
                {5, 10, 12, 1, 20, 0},
                {5, 10, 12, 1, 0, 5},
                {10, 10, 12, 1, 3, 8},
                {10, 10, 12, 1, 5, 6},
                {10, 10, 12, 1, 10, 1},
                {10, 10, 12, 1, 20, 0},
                {10, 10, 12, 1, 0, 10},
                {20, 10, 12, 1, 3, 8},
                {20, 10, 12, 1, 5, 6},
                {20, 10, 12, 1, 10, 1},
                {20, 10, 12, 1, 20, 0},
                {20, 10, 12, 1, 0, 10},
                {0, 10, 12, 1, 3, 0},
                {0, 10, 12, 1, 5, 0},
                {0, 10, 12, 1, 10, 0},
                {0, 10, 12, 1, 20, 0},
                {0, 10, 12, 1, 0, 0},
                {5, 10, 0, 0, 3, 0},
                {5, 10, 0, 0, 5, 0},
                {5, 10, 0, 0, 10, 0},
                {5, 10, 0, 0, 20, 0},
                {5, 10, 0, 0, 0, 0},
                {10, 10, 0, 0, 3, 0},
                {10, 10, 0, 0, 5, 0},
                {10, 10, 0, 0, 10, 0},
                {10, 10, 0, 0, 20, 0},
                {10, 10, 0, 0, 0, 0},
                {20, 10, 0, 0, 3, 0},
                {20, 10, 0, 0, 5, 0},
                {20, 10, 0, 0, 10, 0},
                {20, 10, 0, 0, 20, 0},
                {20, 10, 0, 0, 0, 0},
                {0, 10, 0, 0, 3, 0},
                {0, 10, 0, 0, 5, 0},
                {0, 10, 0, 0, 10, 0},
                {0, 10, 0, 0, 20, 0},
                {0, 10, 0, 0, 0, 0}
            };

            RunTestArray(values);
        }

        private void RunTestArray(int[,] values)
        {
            for (int i = 0; i < values.GetLength(0); i++)
            {
                Calculator.CalculateDiscountToApply(values[i, 0],
                    values[i, 1],
                    values[i, 2],
                    values[i, 3],
                    values[i, 4]).Should().Be(values[i, 5], "row={0}", i);
            }
        }
    }
}
